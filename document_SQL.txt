CREATE PROC Update_SL_Ton
    @MaSP int,
	@MaPhieuNhapHang nchar(10)
AS
    update THONGTINSANPHAM
	set SLTon = (select CT_PHIEUNHAPHANG.Sluong from CT_PHIEUNHAPHANG where CT_PHIEUNHAPHANG.MaSanPham=@MaSP and CT_PHIEUNHAPHANG.MaPhieuNhapHang=@MaPhieuNhapHang) + SLTon
	where MaSanPham=@MaSP
GO


CREATE PROC Update_TongSL_PN
		@MaPhieuNH nchar(10)
AS
	update PHIEUNHAPHANG
	set TongSL=(select COUNT(MaPhieuNhapHang) 
				from CT_PHIEUNHAPHANG 
				where CT_PHIEUNHAPHANG.MaPhieuNhapHang=@MaPhieuNH
				group by MaPhieuNhapHang )
	where PHIEUNHAPHANG.MaPhieuNhapHang=@MaPhieuNH
GO

CREATE PROC Update_TongTien_PN
		@MaPhieuNH nchar(10)
AS
	update PHIEUNHAPHANG
	set TongTien_NH=(select SUM(CT_PHIEUNHAPHANG.TongTien)
				from CT_PHIEUNHAPHANG 
				where CT_PHIEUNHAPHANG.MaPhieuNhapHang=@MaPhieuNH)
	where PHIEUNHAPHANG.MaPhieuNhapHang=@MaPhieuNH
GO